var maxLength=20;function onlyWhiteSpace(b){var a,c;for(c=0;c<b.length;c++){a=b.charCodeAt(c);if((a!=9)&&(a!=10)&&(a!=32)){break}}return(c==b.length)}function getAttrList(d){var b=Array(Array("id","Id"),Array("target","Target"),Array("href","Link"),Array("name","Name"),Array("src","Source"),Array("class","Class")),a="",c;for(c=0;c<b.length;c++){if(d.attr(b[c][0])){a+=", "+b[c][1]+"='";a+=d.attr(b[c][0])+"'"}}return a}function FormatText(a){if(a.length>maxLength){a=a.substr(0,maxLength)+"...("+a.length+" Z.)"}return a}function createElementTree(b){var a=$("<ol>");b.data("mountPoint",a);b.each(function(e){var f=$(this);switch(f.attr("nodeType")){case 3:var g=f.attr("nodeValue");if(onlyWhiteSpace(g)){break}var c=$("<li>").html("Text: '"+FormatText(g)+"'");break;case 1:if(f.attr("tagName")=="SCRIPT"){break}var c=$("<li>").html(f.attr("tagName")+getAttrList(f));if(f.children().length>0){var d=f.children(":first");if((f.children().length==1)&&(d.attr("nodeType")==3)&&(!onlyWhiteSpace(d.attr("nodeValue")))){$(c).append(", Text: '"+FormatText(d.attr("nodeValue"))+"'")}else{createElementTree(f.children()).appendTo(c)}}break;default:break}if(!c){return}c.data("LinkElement",f);c.click(function(i){i.stopPropagation();var h=$(this).data("LinkElement");document.ActEle=h;h.effect("highlight",{},"normal")});c.appendTo(f.data("mountPoint"));f.removeData("mountPoint")});return a}function _initGrab(){var b=$('<div id="BWL_Grab" >').css({display:"none"}),a=$("<h2>Grab Window</h2>");b.draggable({handle:a,cursor:"move"});EleContainer=$("<div>").append(createElementTree($("body")));b.append(a.add(EleContainer)).appendTo("body").show("slow")};